import numpy as np
import matplotlib.pyplot as plt
# defining test variables below
from julia import Main

Main.include("../pycosie/utils/GaussSmooth.jl")

testCoord = np.array([[2.07736740e+01, 1.60033506e+04, 5.13922559e+03],
 [5.14218569e-01, 1.60169346e+04, 5.14904004e+03],
 [1.58728588e+00, 1.59931367e+04, 5.14931299e+03],
 [1.58192596e+01, 1.59792842e+04, 5.14353027e+03],
 [6.87668896e+00, 1.59753633e+04, 5.12603320e+03],
 [2.93274999e+00, 1.59325391e+04, 5.14392627e+03],
 [3.53954339e+00, 1.59510371e+04, 5.12327734e+03],
 [1.31646051e+01, 1.59543203e+04, 5.14149805e+03],
 [3.11179028e+01, 1.59640557e+04, 5.13599268e+03],
 [6.97964382e+00, 1.59257637e+04, 5.18304932e+03],
 [3.99651527e-01, 1.59886113e+04, 5.19880811e+03],
 [1.61684875e+01, 1.59760879e+04, 5.18782764e+03],
 [1.25487289e+01, 1.59628574e+04, 5.21423779e+03],
 [3.02467227e+00, 1.59555576e+04, 5.19171924e+03],
 [3.37019844e+01, 1.59520469e+04, 5.19918213e+03],
 [2.82811508e+01, 1.59835820e+04, 5.20714209e+03],
 [4.01732979e+01, 1.59850859e+04, 5.18110400e+03],
 [3.34147072e+01, 1.59640693e+04, 5.17853369e+03],
 [2.80351448e+01, 1.59823525e+04, 5.16042236e+03],
 [4.17654610e+01, 1.59682246e+04, 5.15337695e+03],
 [2.49370136e+01, 1.59457402e+04, 5.17871240e+03],
 [3.82811737e+01, 1.59432568e+04, 5.15398389e+03],
 [2.28171558e+01, 1.59573887e+04, 5.16171973e+03],
 [1.40380507e+01, 1.59397188e+04, 5.16176709e+03],
 [5.47885323e+00, 1.59733340e+04, 5.16856836e+03],
 [1.65250435e+01, 1.60152988e+04, 5.16478955e+03],
 [1.35944805e+01, 1.59931113e+04, 5.16712646e+03],
 [2.91286888e+01, 1.60046611e+04, 5.15562695e+03],
 [2.21769638e+01, 1.59963027e+04, 5.18611816e+03],
 [8.21499729e+00, 1.60117891e+04, 5.19507715e+03],
 [1.04875593e+01, 1.59966689e+04, 5.22061475e+03],
 [1.64753145e+04, 1.60040117e+04, 5.21353320e+03],
 [1.64693008e+04, 1.59950195e+04, 5.18893506e+03],
 [1.64871836e+04, 1.60019307e+04, 5.15456689e+03],
 [1.64773105e+04, 1.60164795e+04, 5.16381885e+03],
 [1.64845039e+04, 1.60191045e+04, 5.18431982e+03],
 [1.64952148e+04, 1.60042529e+04, 5.17426855e+03],
 [1.64893516e+04, 1.59817549e+04, 5.17873486e+03],
 [1.64790078e+04, 1.59812578e+04, 5.15907373e+03],
 [1.64944688e+04, 1.59482637e+04, 5.17119287e+03],
 [1.64632832e+04, 1.59534150e+04, 5.15991260e+03],
 [1.64610332e+04, 1.59877510e+04, 5.16729590e+03],
 [1.64734375e+04, 1.59603652e+04, 5.18084033e+03],
 [1.64529512e+04, 1.59375547e+04, 5.19144678e+03],
 [1.64868887e+04, 1.59316592e+04, 5.19914893e+03],
 [1.64819434e+04, 1.59669600e+04, 5.20588525e+03],
 [1.64896309e+04, 1.59741992e+04, 5.23066846e+03],
 [1.64405645e+04, 1.59643564e+04, 5.17249463e+03],
 [1.64435859e+04, 1.59736768e+04, 5.19932275e+03],
 [1.64772441e+04, 1.59256934e+04, 5.17503369e+03],
 [1.64982559e+04, 1.59200244e+04, 5.16271045e+03],
 [1.64706211e+04, 1.59784014e+04, 5.13937646e+03],
 [1.64510898e+04, 1.59794580e+04, 5.14961621e+03],
 [1.64849121e+04, 1.59416709e+04, 5.15290869e+03],
 [1.64760586e+04, 1.59433018e+04, 5.13498096e+03],
 [1.64966465e+04, 1.59672305e+04, 5.14996680e+03],
 [1.64872031e+04, 1.59601895e+04, 5.13511670e+03],
 [1.64901680e+04, 1.59875000e+04, 5.13404297e+03],
 [1.64824160e+04, 1.60025361e+04, 5.13954785e+03],])


testDx = 16497.856207847595
testDy = 99.080078125
testDz = 107.39111328125

testDomainWidth = np.array([16500., 16500., 16500.])

# initial plot to show points are very separate along x axis
ax = plt.figure().add_subplot(projection='3d')

#ax.scatter(gCoord[:,0], gCoord[:,1], zs=gCoord[:,2],color="blue", s=1, alpha=0.5)
#ax.scatter(dmCoord[:,0], dmCoord[:,1], zs=dmCoord[:,2], color="black", s=1, alpha=0.5)
ax.scatter(testCoord[:,0], testCoord[:,1], 
           zs=testCoord[:,2], color="blue", s=1, alpha=0.5)
ax.set_title("Separated")
plt.show()

# recentering
recCoord = Main.recenter(testCoord, testDomainWidth, testDx, testDy, testDz)

# new plot showing recentering
ax = plt.figure().add_subplot(projection='3d')

#ax.scatter(gCoord[:,0], gCoord[:,1], zs=gCoord[:,2],color="blue", s=1, alpha=0.5)
#ax.scatter(dmCoord[:,0], dmCoord[:,1], zs=dmCoord[:,2], color="black", s=1, alpha=0.5)
ax.scatter(recCoord[:,0], recCoord[:,1], 
           zs=recCoord[:,2], color="blue", s=1, alpha=0.5)
ax.set_title("Recentered")
plt.show()

